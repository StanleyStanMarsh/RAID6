# RAID6 реализация (RAID6 implemenation)

## Описание (Eng. version)

### Математическое описание

RAID (Redundant Array of Independent Disks) - это технология, позволяющая объединять несколько физических дисков в один логический модуль для улучшения отказоустойчивости и производительности системы. RAID6 - это шестой уровень RAID, который обеспечивает высокую степень надежности за счет двойной четности.

### RAID6

RAID6 использует чередование данных с двойной распределенной четностью, что позволяет массиву оставаться доступным даже после двух последовательных сбоев. Для функционирования RAID6 необходимо минимум четыре диска, включая два для данных и два для управления четностью.

Распределение блоков данных и блоков избыточности для RAID 6 на 5 дисках в приложении происходит в соответсвии с *рис. ниже*. Таким образом, на представленной схеме: блоки данных - $A1-A3$, $B1-B3$, $C1-C3$, $D1-D3$, $E1-E3$ и блоки избыточности - $A_p$, $A_q$, $B_p$, $B_q$, $C_p$, $C_q$, $D_p$, $D_q$, $E_p$, $E_q$.

![scheme1](https://github.com/StanleyStanMarsh/RAID6/assets/96591356/36271c45-9692-44ca-b7ab-ac48195c6dad)

## Полином для генерации блоков избыточности

Для расчета блока избыточности используется полиномиальное выражение. Данные преобразуются в полином, где каждый блок данных становится подставляемым в полином. Восстановление данных происходит через решение системы полиномиальных уравнений, созданных на основе сохраненных данных и избыточных блоков.

### Особенности реализации

#### Представление дисков

В симуляции диски представлены текстовыми файлами. Один диск - один файл. Файлы хранятся в рабочем каталоге приложения и доступны в процессе работы.

#### Запись и чтение данных

Для записи и чтения данных используются команды write и read.

Для записи информации на диски пользователь использует команду:

`<address> write <data>`,

где *address* - адрес (строка) от 0 до 63, по которому пользователь хочет записать сообщение, *data* - строка-сообщение, которое должно состоять строго из 14 символов и которое должно содержать символы только шестнадцатеричной системы счисления.

Определение расположения блоков данных и избыточности зависит от заданного адреса - на основе деления адреса по модулю от числа дисков. На условной матрице 5x5 будет выбираться номер строки - остаток от деления адреса на число 5 - в которой содержатся номера избыточных дисков. Сообщение разделяется на три части: по 5 байтов в первых двух и 4 байта в последней. Каждая часть затем записывается в отдельный блок данных.

Подсчет блоков избыточности происходит с помощью двух полиномов и записывается в соответствующие ячейки:

$$
A + B + C = X
$$

$$
A + 2B + 3C = Y
$$

Переменные полинома $A$, $B$, $C$ последовательно соответствуют блокам данных. Например, для вычисления избыточности p по адресу 0, значение из блока $A1$ конвертируется из шестнадцатеричной в десятичную систему и помещается в переменную $A$, блок $A2$ записывается в переменную $B$, а блок $A3$ - в переменную $C$.

Для чтения информации с дисков пользователь использует команду:

`<address> read`,

где *address* - адрес (строка) от 0 до 63, из которого пользователь хочет прочитать сообщение. Сначала следует проверить, произошла ли потеря дисков. Если диски на месте, то с указанного адреса происходит чтение частей сообщения из блоков данных, которые затем собираются в единую строку и выводятся пользователю. Если же один или два диска пропали, тогда необходимо анализировать разные варианты: утеряны ли блоки данных или избыточности, согласно адресу, указанному пользователем. В данной реализации потерянные диски не восстанавливаются, а восстанавливаются лишь конкретные данные по запрашиваемому адресу.

Рассматриваются всевозможные комбинации потери блоков, восстанавливаются данные и пользователю выводится строка:

1. Если утеряны два и меньше блока контрольных сумм и не утеряны блоки данных, то достаточно просто объединить части сообщения из блоков данных в строку и вывести пользователю. Блоки контрольных сумм подсчитываются с помощью полиномов и сохраненных данных и записываются на заново созданные диски.
   - Если утерян блок данных A, то решается уравнение вида: $$A = X - B - C$$
   - Если утерян блок данных B, то решается уравнение вида: $$B = X - A - C$$
   - Если утерян блок данных C, то решается уравнение вида: $$C = X - A - B$$

2. Если не утеряны 2 диска избыточности и утеряны 2 диска данных, то опять необходимо в зависимости от комбинации блоков решить уже систему из двух полиномиальных уравнений. 
   
   Утеряны 2 блока данных:
   - Если утеряны блок А и блок B:
      
     $$A = X - C$$
     $$B = Y - 2C - A$$
     
   - Если утеряны блок А и блок C:
     
      $$C = (Y - B - A) / 2$$
      $$A = X - B - C$$
     
   - Если утеряны блок B и блок C: 
      $$B = 3X - 2A - Y$$
      $$C = (Y - A - 2B) / 3$$

   Утеряны 1 блок данных и 1 блок избыточности:
   - Если утеряны блок А и блок X:
     
     $$A = Y - 2B - 3C$$

   - Если утеряны блок А и блок Y: 
     
     $$A = X - B - C$$

   - Если утеряны блок B и блок X: 
     
     $$B = (Y - A - 3C) / 2$$

   - Если утеряны блок B и блок Y: 
     
     $$B = X - A - C$$

   - Если утеряны блок C и блок X: 

     $$C = (Y - A - 2B) / 3$$

   - Если утеряны блок C и блок Y: 
     
     $$C = X - A - B$$

### Результаты работы

Приложение предоставляет пользователю возможность выполнять операции чтения и записи данных по указанным адресам. В случае потери дисков, приложение позволяет восстановить данные по запрашиваемому адресу.

![pic2](https://github.com/StanleyStanMarsh/RAID6/assets/96591356/a34ce1fd-7da5-444b-ba39-5830f6005a26)

![pic5](https://github.com/StanleyStanMarsh/RAID6/assets/96591356/a4803417-75ca-459b-a6d8-a32d28097018)
